{% extends 'base.html' %}
{% load static %}

{% block title %}{% if colaborador %}Editar{% else %}Cadastrar{% endif %} Colaborador{% endblock %}

{% block content %}

    <div class="page-header">
        <h1>{% if colaborador %}Editar{% else %}Cadastrar{% endif %} Colaborador</h1>
        <a href="{% url 'index' %}" class="btn-submit" style="background-color: #718096;">
            <svg class="icon"><use href="#icon-arrow-left"></use></svg>
            Voltar para a lista
        </a>
    </div>

    <div class="form-card">
        <div class="form-header">
            <svg class="icon-large"><use href="#icon-plus-circle"></use></svg>
            <h2>{% if colaborador %}Dados do Colaborador{% else %}Novo Colaborador{% endif %}</h2>
        </div>
        
        <!-- ============================================= -->
        <!-- O FORMULÁRIO (SEM AS MENSAGENS ANTIGAS) -->
        <!-- ============================================= -->
        <form id="colaborador-form" method="POST">
            {% csrf_token %} 
            
            <!-- Campo Nome Completo -->
            <div class="form-group">
                <label for="id_nome_completo">Nome Completo <span class="required">*</span></label>
                {{ form.nome_completo }}
            </div>

            <!-- Campo Matrícula -->
            <div class="form-group">
                <label for="id_matricula">Matrícula <span class="required">*</span></label>
                {{ form.matricula }}
            </div>

            <!-- Campo Função -->
            <div class="form-group">
                <label for="id_funcao">Função <span class="required">*</span></label>
                {{ form.funcao }}
                <datalist id="lista-funcoes">
                    <option value="Almoxarife">
                    <option value="Pedreiro">
                    <option value="Eletricista">
                    <option value="Mestre de Obras">
                    <option value="Carpinteiro">
                    <option value="Servente">
                    <option value="Armador">
                </datalist>
            </div>

            <!-- Campo Status -->
            <div class="form-group">
                <label for="id_status">Status <span class="required">*</span></label>
                {{ form.status }}
            </div>

            <!-- Botão Salvar -->
            <div class="form-actions">
                <button type="submit" class="btn-submit">
                    <svg class="icon"><use href="#icon-save"></use></svg>
                    Salvar Colaborador
                </button>
            </div>
        </form>
    </div>


    <!-- ============================================= -->
    <!-- (NOVO) HTML DO MODAL DE FEEDBACK -->
    <!-- ============================================= -->
    <div class="modal-backdrop" id="feedbackModalBackdrop" style="display: none;"></div>
    <div class="modal" id="feedbackModal" style="display: none;">
        <div class="modal-header" id="feedbackModalHeader">
            <h3 id="feedbackModalTitle"></h3>
            <button class="modal-close" id="feedbackModalCloseBtn">&times;</button>
        </div>
        <div class="modal-body">
            <p id="feedbackModalBody"></p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn-secondary" id="feedbackModalOkBtn">OK</button>
        </div>
    </div>
    
    <!-- (NOVO) DIV SECRETA PARA PASSAR MENSAGENS DO DJANGO PARA O JS -->
    <div id="feedbackData" 
         data-success-message="{% for message in messages %}{% if message.tags == 'success' %}{{ message }}{% endif %}{% endfor %}"
         data-error-message="{% if form.errors %}{% for field, errors in form.errors.items %}{{ errors.0 }}{% endfor %}{% endif %}"
    ></div>

{% endblock %}